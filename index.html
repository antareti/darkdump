<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>WebScraper-Pro — Terminal Edition</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ============ СТИЛИ ============ */
:root {
    --bg: #050505;
    --accent: #ff7f00;
    --accent-soft: #ffa31a;
    --text: #f5f5f5;
    --muted: #888;
    --green: #00ff7f;
    --cyan: #00e5ff;
    --red: #ff4b4b;
}

body {
    background: #000;
    color: var(--text);
    font-family: Consolas, "Fira Code", monospace;
    margin: 0;
    display: flex;
    justify-content: center;
    padding: 30px;
}

.terminal {
    width: 100%;
    max-width: 900px;
    height: 85vh;
    background: #0a0a0a;
    border: 1px solid rgba(255,127,0,0.4);
    box-shadow: 0 0 25px rgba(255,127,0,0.15);
    border-radius: 14px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.header {
    padding: 10px 12px;
    background: #111;
    border-bottom: 1px solid rgba(255,127,0,0.3);
    font-size: 13px;
    color: var(--muted);
}

.output {
    flex: 1;
    padding: 12px;
    overflow-y: auto;
    background: radial-gradient(circle at top, rgba(255,127,0,0.1), #000 75%);
}

.input-box {
    display: flex;
    padding: 8px 12px;
    border-top: 1px solid rgba(255,127,0,0.3);
    background: #000;
}

.prompt {
    color: var(--accent-soft);
    margin-right: 8px;
}

input {
    flex: 1;
    background: transparent;
    color: var(--text);
    border: none;
    outline: none;
    font-family: inherit;
    font-size: 15px;
}

.line { margin-bottom: 4px; }
.muted { color: var(--muted); }
.info { color: var(--cyan); }
.ok { color: var(--green); }
.error { color: var(--red); }
.warn { color: var(--accent-soft); }
.banner { color: var(--accent); font-weight: bold; }
.result-link { color: var(--accent-soft); text-decoration: none; }
</style>
</head>

<body>

<div class="terminal">
    <div class="header">WebScraper-Pro — Terminal Browser Edition</div>

    <div class="output" id="out"></div>

    <div class="input-box">
        <div class="prompt">webscraper&gt;</div>
        <input id="inp" type="text" autofocus autocomplete="off" placeholder='пример: search ip scan -a 5'>
    </div>
</div>


<script>
/* ============ JS ЛОГИКА ============ */
const out = document.getElementById("out");
const inp = document.getElementById("inp");
const BING = "https://www.bing.com/search?q=";

function line(text="", cls="") {
    let div = document.createElement("div");
    div.className = "line " + cls;
    div.innerHTML = text;
    out.appendChild(div);
    out.scrollTop = out.scrollHeight;
}

function banner() {
    line(" __        __     _     ____                                      ", "banner");
    line(" \\ \\      / / ___| |__ |  _ \\ _ __ ___   ___ _ __  _ __   ___ _ __", "banner");
    line("  \\ \\ /\\ / / / _ \\ '_ \\| |_) | '__/ _ \\ / _ \\ '_ \\| '_ \\ / _ \\ '__|", "banner");
    line("   \\ V  V / |  __/ |_) |  __/| | | (_) |  __/ |_) | |_) |  __/ |   ", "banner");
    line("    \\_/\\_/   \\___|_.__/|_|   |_|  \\___/ \\___| .__/| .__/ \\___|_|   ", "banner");
    line("                                           |_|   |_|                ", "banner");
    line();
    line("Команды: search, clear, help", "muted");
    line();
}

banner();

function parseCommand(cmd) {
    line("webscraper> " + cmd, "muted");

    let p = cmd.trim().split(" ");
    let base = p[0];

    if (base === "clear") {
        out.innerHTML = "";
        banner();
        return;
    }

    if (base === "help") {
        line("search <запрос> -a N    выполнить поиск", "info");
        line("clear                   очистить", "info");
        return;
    }

    if (base === "search") {
        let amount = 10;
        let query = [];

        for (let i=1; i<p.length; i++) {
            if (p[i] === "-a" && p[i+1]) {
                amount = parseInt(p[i+1]) || 10;
                i++;
            } else {
                query.push(p[i]);
            }
        }

        let q = query.join(" ").trim();
        if (!q) {
            line("[!] Укажи запрос!", "error");
            return;
        }

        search(q, amount);
        return;
    }

    line("[!] Неизвестная команда.", "error");
}

async function search(q, amount) {
    line("[i] Запрос: " + q, "info");
    const url = BING + encodeURIComponent(q);
    line("[i] URL: " + url, "info");
    line();

    let resp;
    try {
        resp = await fetch(url);
    } catch (e) {
        line("[!] Ошибка соединения: " + e, "error");
        return;
    }

    if (!resp.ok) {
        line("[!] Bing вернул " + resp.status, "error");
        return;
    }

    let html;
    try {
        html = await resp.text();
    } catch (e) {
        line("[!] CORS блокирует чтение HTML", "error");
        line("[~] Создай простой backend-прокси, если хочешь рабочий парсер.", "warn");
        return;
    }

    const parser = new DOMParser();
    const doc = parser.parseFromString(html, "text/html");
    const results = doc.querySelectorAll("li.b_algo");

    if (results.length === 0) {
        line("[~] Bing ничего не дал или структура изменилась.", "warn");
        return;
    }

    let show = Math.min(amount, results.length);
    line("[+] Найдено: " + results.length + " | Показываю: " + show, "ok");
    line();

    for (let i=0; i<show; i++) {
        let b = results[i];

        let a = b.querySelector("h2 a");
        if (!a) continue;

        let title = a.textContent.trim();
        let link = a.href;
        let snip = b.querySelector("p") ? b.querySelector("p").textContent.trim() : "";

        line((i+1) + ". " + title, "ok");
        line(`<a class="result-link" href="${link}" target="_blank">URL: ${link}</a>`);
        if (snip) line("   " + snip);
        line();
    }

    line("[✓] Готово.", "ok");
    line();
}

inp.addEventListener("keydown", e => {
    if (e.key === "Enter") {
        let cmd = inp.value;
        inp.value = "";
        parseCommand(cmd);
    }
});
</script>

</body>
</html>
